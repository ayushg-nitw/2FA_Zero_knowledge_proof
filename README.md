Two-Factor Authentication System with Zero-Knowledge Proofs
This project implements a secure two-factor authentication system using a trusted device model with Zero-Knowledge Proofs (ZKP). The system provides strong security by requiring authentication from both a trusted and untrusted device, ensuring that even if credentials are compromised on an untrusted device, attackers cannot gain access without physical access to the trusted device.

Table of Contents
Overview

Components

Requirements

Installation

Usage

Security Features

Common Issues

Technical Details

Overview
The system uses a two-token approach for authentication:

Token1: Generated by the trusted device and entered on the untrusted device to initiate login

Token2: Generated after Zero-Knowledge Proof verification on the trusted device and entered on the untrusted device to complete login

This approach ensures that authentication requires both knowledge (password on trusted device) and possession (access to the trusted device), providing strong two-factor security.

Components
The system consists of three main components:

1. Authentication Server (server.c)
Manages user registration and authentication

Handles token verification

Coordinates the ZKP authentication process

Maintains login state and session management

2. Trusted Device (trusted_device.c)
Securely stores user credentials

Generates Token1 for login initiation

Performs Zero-Knowledge Proof to verify identity

Generates Token2 after successful verification

3. Untrusted Device (untrusted_device.c)
Provides interface for entering Token1 and Token2

Communicates with the server for authentication

Does not store any sensitive information

Requirements
GCC compiler

OpenSSL development libraries

POSIX-compliant operating system (Linux/Unix/macOS)

Installation
Install dependencies:

bash
gcc -o server server.c -lssl -lcrypto
gcc -o trusted_device trusted_device.c -lssl -lcrypto
gcc -o untrusted_device untrusted_device.c
Usage
Running the System
Start the server first:

bash
./trusted_device
# Select option 2 for login
# Enter username and password
# Note the Token1 displayed
On the untrusted device:

bash
./untrusted_device
# Enter username
# Enter Token1 from trusted device
Back on the trusted device:

Confirm the login request by typing "Yes"

Note the Token2 displayed

On the untrusted device:

bash
# Enter Token2 from trusted device
Security Features
Zero-Knowledge Proofs: Allows the trusted device to prove knowledge of the password without revealing it

Two-factor authentication: Requires both knowledge (password) and possession (trusted device)

Temporary tokens: Both Token1 and Token2 are single-use and expire after a short time

Device signatures: Trusted device signs messages to prevent tampering

Login confirmation: Requires explicit confirmation on trusted device to continue login process

Common Issues
Token expiration: Login tokens expire after 5 minutes. If you're experiencing "Invalid token" errors, try restarting the login process.

Buffer issues with Token2: When entering Token2, ensure there are no extra spaces or newlines. Tokens must be exactly 16 characters.

No login confirmation: If the trusted device doesn't detect a login confirmation request, try checking manually or restarting the login process.

Connection failures: Ensure the server is running and accessible before attempting login.

Technical Details
Token format: Alphanumeric tokens of 16 characters

Network protocol: Simple TCP-based request/response system

ZKP algorithm: Based on the discrete logarithm problem

Key storage:

Server: Stores user public keys

Trusted device: Stores user secret keys locally in device_keys.txt

Default server: Localhost (127.0.0.1) on port 8080

This project is for educational purposes only. For production systems, additional security measures should be implemented.

bash
# For Debian/Ubuntu
sudo apt-get install gcc libssl-dev

# For macOS
brew install openssl
Clone the repository:

bash
git clone https://github.com/username/two-factor-zkp-auth.git
cd two-factor-zkp-auth
Compile the code:

bash
./server
On the trusted device, register a new account:

bash
./trusted_device
# Select option 1 for registration
# Enter username and password
To perform login:

On the trusted device:
